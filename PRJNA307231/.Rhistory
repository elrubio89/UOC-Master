length(unique(muestras_estudio$Id_Pacient))
length(unique(frotis_excl3$NHC))
rm(data)
muestras_estudio3<-subset(muestras_estudio2, muestras_estudio2$dias %in% -5:30)
min(muestras_estudio3$dias)
max(muestras_estudio3$dias)
length(unique(muestras_estudio3$NHC))
View(muestras_estudio3)
write.xlsx(muestras_estudio3, "/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/cultivos/cultivos_pacientes.xlsx")
frotis_excl3<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/frotis_excl2_modificado.xlsx")
library(stringr)
library(openxlsx)
frotis_excl3<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/frotis_excl2_modificado.xlsx")
library(haven)
library(readxl)
library(openxlsx)
frotis_excl3<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/frotis_excl2_modificado.xlsx")
frotis_excl3<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/frotis_excl2_modificado.xlsx")
frotis_excl3<-subset(frotis_excl3, frotis_excl3$Disponible_SN==1)
table(frotis_excl3$Cultivo_PN, useNA = "ifany")
table(frotis_excl3$CI, useNA = "ifany")
View(frotis_excl3)
datos3<-frotis_excl3[ ,c("NHC", "CI")]
View(datos3)
datos3<-unique(datos3)
table(datos3$CI)
frotis_excl3$Frotis_episodio<-str_sub(frotis_excl3$Paciente_Episodio_Frotis, 9,10)
frotis_excl3<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/frotis_excl3.xlsx")
str(frotis_excl3)
copros<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/cultivos/Extracte de resultats del box de Coprocultius entre_ 01.05.2018 i 01.02.2019.xls")
hemos<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/cultivos/Extracte de resultats del box de Hemocultius entre_ 01.05.2018 i 01.02.2019.xls")
frotis<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/cultivos/Extracte de resultats del box de Frotis entre_ 01.05.2018 i 01.02.2019.xls")
respis<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/cultivos/Extracte de resultats del box de Mostres Respiratories entre_ 01.05.2018 i 01.02.2019.xls")
orinas<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/cultivos/Extracte de resultats del box de Urinocultius entre_ 01.05.2018 i 01.02.2019.xls")
varis<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/cultivos/Extracte de resultats del box de Varis entre_ 01.05.2018 i 01.02.2019.xls")
virus<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/cultivos/Extracte de resultats del box de Virologia entre_ 01.05.2018 i 01.02.2019.xls")
names(copros)
names(frotis)
names(virus)
str(copros$Id_Pacient)
muestras<-rbind(copros, frotis, hemos, orinas, respis, varis, virus)
str(muestras)
View(muestras)
muestras$Id_Pacient<-as.numeric(muestras$Id_Pacient)
##Selecciono solo los cultivos de los pacientes del estudio:
muestras_estudio<-subset(muestras, muestras$Id_Pacient%in% frotis_excl3$NHC)
##Seleccionar solo los cultivos que se hayan recogido entre
##-5 y +30 días de fecha de ingreso en UCI para cada paciente:
##Primero unifico las dos bases de datos
muestras_estudio2<-merge(frotis_excl3, muestras_estudio, by.x = "NHC",  by.y="Id_Pacient", all = TRUE)
muestras_estudio2$Data_Registre<-as.Date(muestras_estudio2$Data_Registre, "%y-%m-%d")
muestras_estudio2$Data_Ingreso_UCI<-as.Date(muestras_estudio2$Data_Ingreso_UCI, "%y-%m-%d")
muestras_estudio2$dias<-muestras_estudio2$Data_Registre - muestras_estudio2$Data_Ingreso_UCI
muestras_estudio3<-subset(muestras_estudio2, muestras_estudio2$dias %in% -5:30)
str(muestras_estudio3)
View(muestras_estudio3)
unique(muestras_estudio3$Codigo_frotis)
length(unique(muestras_estudio3$Codigo_frotis))
(unique(muestras_estudio3$Codigo_frotis)%in%frotis_excl3$Codigo_frotis
)
table(unique(muestras_estudio3$Codigo_frotis)%in%frotis_excl3$Codigo_frotis)
table(unique(muestras_estudio3$Codigo_frotis)%in%frotis_excl3$Codigo_frotis)
length(unique(frotis_excl3$Paciente_Episodio))
table(muestras_estudio3$`Tipus de Mostra`)
table(muestras_estudio3$Estudi)
table(muestras_estudio3$Cultiu)
table(muestras_estudio3$Modificador)
names(muestras_estudio3)
nrow(unique(muestras_estudio3[ ,1:32]))
nrow(unique(muestras_estudio3[ ,33:50]))
names(muestras_estudio3[ ,33:50])
########Solo con hemos posotivos
hemos
View(hemos)
table(hemos$Cultiu)
hemos_posz<-subset(hemos, hemos$Cultiu=="Positivo")
rm(hemos_posz)
hemos_pos<-subset(hemos, hemos$Cultiu=="Positivo")
hemos_pos$Id_Pacient<-as.numeric(hemos_pos$Id_Pacient)
hemos_pos_estudio<-subset(hemos_pos,hemos_pos$Id_Pacient%in% frotis_excl3$NHC)
hemos_pos_estudio2<-merge(frotis_excl3, hemos_pos_estudio, by.x = "NHC",  by.y="Id_Pacient", all = TRUE)
View(hemos_pos_estudio2)
table(hemos$Quantificacio)
hemos$Id_Pacient<-as.numeric(hemos$Id_Pacient)
hemos_estudio<-subset(hemos,hemo$Id_Pacient%in% frotis_excl3$NHC)
hemos_estudio<-subset(hemos,hemos$Id_Pacient%in% frotis_excl3$NHC)
table(hemos_estudio$Quantificacio)
View(hemos_estudio)
rm(hemos_pos)
rm(hemos_pos_estudio)
rm(hemos_pos_estudio2)
hemos_estudio2<-merge(frotis_excl3, hemos_estudio, by.x = "NHC",  by.y="Id_Pacient", all = TRUE)
hemos_estudio2$Data_Registre<-as.Date(hemos_estudio$Data_Registre, "%y-%m-%d")
hemos_estudio2$Data_Registre<-as.Date(hemos_estudio2$Data_Registre, "%y-%m-%d")
hemos_estudio2$Data_Ingreso_UCI<-as.Date(hemos_estudio2$Data_Ingreso_UCI, "%y-%m-%d")
hemos_estudio2$dias<-hemos_estudio2$Data_Registre - hemos_estudio2$Data_Ingreso_UCI
hemos_estudio2<-subset(hemos_estudio2, hemos_estudio2$dias %in% -5:30)
View(hemos_estudio2)
table(hemos_estudio2$Quantificacio)
hemos_estudio_pos<-subset(hemos_estudio2, hemos_estudio2$Quantificacio %in% c("Se aislan colonias","Hemocultivo positivo"))
table(hemos_estudio_pos$Quantificacio)
View(hemos_estudio_pos)
table(hemos_estudio_pos$Aillament)
table(hemos_estudio_pos$Paciente_Episodio)
length(unique(hemos_estudio_pos$Paciente_Episodio))
table(hemos_estudio_pos$`Tipus de Mostra`)
hemos_estudio_pos<-subset(hemos_estudio_pos, hemos_estudio_pos$`Tipus de Mostra`!="Catéter vascular")
table(hemos_estudio_pos$`Tipus de Mostra`)
table(frotis_excl3$Cultivo_PN)
hemos_estudio_pos$`Tipus de Mostra`=="Hemocultivo (una extracción)"<-"Hemocultivo 1"
hemos_estudio_pos[hemos_estudio_pos$`Tipus de Mostra`=="Hemocultivo (una extracción)", hemos_estudio_pos$`Tipus de Mostra`]
hemos_estudio_pos[hemos_estudio_pos$`Tipus de Mostra`=="Hemocultivo (una extracción)", "Tipus de Mostra"]
hemos_estudio_pos[hemos_estudio_pos$`Tipus de Mostra`=="Hemocultivo (una extracción)", "Tipus de Mostra"]<-"Hemocultivo 1"
table(hemos_estudio_pos$`Tipus de Mostra`)
View(frotis_excl3)
episodios<-frotis_excl3[ ,-2]
View(episodios)
episodios<-unique(episodios)
episodios<-frotis_excl3[ ,-2]
episodios<-unique(episodios)
names(frotis_excl3)
episodios<-frotis_excl3[ ,-c(2,6,9:20,29:32)]
episodios<-unique(episodios)
unique(episodios$Paciente_Episodio)
length(unique(episodios$Paciente_Episodio))
names(episodios)
names(frotis_excl3)
episodios<-frotis_excl3[ ,-c(2,6,9:20,22,29:32)]
episodios<-unique(episodios)
table(episodios$Paciente_Episodio)
names(frotis_excl3)
episodios<-frotis_excl3[ ,-c(2,6,8:20,22,29:32)]
episodios<-unique(episodios)
table(episodios$Paciente_Episodio)
names(frotis_excl3)
##Modifico un dato que está mal:
frotis_excl3[frotis_excl3$Codigo_frotis=="M064-2", "Paciente_Episodio"]<-"M064_E2"
frotis_excl3[frotis_excl3$Codigo_frotis=="M064-2", "Paciente_Episodio_Frotis"]<-"M064_E2_F1"
##Modifico un dato que está mal:
frotis_excl3[frotis_excl3$Codigo_frotis=="M064-2", "Paciente_Episodio"]<-"M064_E2"
frotis_excl3[frotis_excl3$Codigo_frotis=="M064-2", "Paciente_Episodio_Frotis"]<-"M064_E2_F1"
frotis_excl3[frotis_excl3$Codigo_frotis=="M064-2", "Nº episodio"]<-2
frotis_excl3[frotis_excl3$Codigo_frotis=="M064-2", "Fotis_episodio"]<-"F1"
write.xlsx(frotis_excl3, "/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/frotis_excl3.xlsx")
frotis_excl3<-read_excel("/media/erubio/D04C-A669/Final de residencia/Base de datos/Estudio enterococos/frotis_excl3.xlsx")
str(frotis_excl3)
length(unique(frotis_excl3$Paciente_Episodio))
########Solo con hemos posotivos
hemos$Id_Pacient<-as.numeric(hemos$Id_Pacient)
hemos_estudio<-subset(hemos,hemos$Id_Pacient%in% frotis_excl3$NHC)
hemos_estudio2<-merge(frotis_excl3, hemos_estudio, by.x = "NHC",  by.y="Id_Pacient", all = TRUE)
hemos_estudio2$Data_Registre<-as.Date(hemos_estudio2$Data_Registre, "%y-%m-%d")
hemos_estudio2$Data_Ingreso_UCI<-as.Date(hemos_estudio2$Data_Ingreso_UCI, "%y-%m-%d")
hemos_estudio2$dias<-hemos_estudio2$Data_Registre - hemos_estudio2$Data_Ingreso_UCI
hemos_estudio2<-subset(hemos_estudio2, hemos_estudio2$dias %in% -5:30)
hemos_estudio_pos<-subset(hemos_estudio2, hemos_estudio2$Quantificacio %in% c("Se aislan colonias","Hemocultivo positivo"))
table(hemos_estudio_pos$Quantificacio)
table(hemos_estudio_pos$Aillament)
table(hemos_estudio_pos$Paciente_Episodio)
length(unique(hemos_estudio_pos$Paciente_Episodio))
table(hemos_estudio_pos$`Tipus de Mostra`)
hemos_estudio_pos<-subset(hemos_estudio_pos, hemos_estudio_pos$`Tipus de Mostra`!="Catéter vascular")
table(frotis_excl3$Cultivo_PN)
hemos_estudio_pos[hemos_estudio_pos$`Tipus de Mostra`=="Hemocultivo (una extracción)", "Tipus de Mostra"]<-"Hemocultivo 1"
table(hemos_estudio_pos$`Tipus de Mostra`)
names(frotis_excl3)
episodios<-frotis_excl3[ ,-c(2,6,8:20,22,29:32)]
episodios<-unique(episodios)
table(episodios$Paciente_Episodio)
episodios$Hemo_pos_SN<-ifelse(episodios$Paciente_Episodio %in% hemos_estudio_pos$Paciente_Episodio, 1, 0)
table(episodios$Hemo_pos_SN)
Q1 <- matrix(c(rep(1, 4), rep(2, 4), rep(3, 4), rep(4, 4)),4,4)
Q1
Q2 <- mapply(rep,1:4,4)
Q2
install.packages(c("backports", "BH", "bit64", "broom", "callr", "cli", "clipr", "colorspace", "covr", "cpp11", "crayon", "crosstalk", "data.table", "DBI", "desc", "devtools", "digest", "dplyr", "DT", "fansi", "farver", "fastmap", "forcats", "Formula", "generics", "ggplot2", "ggrepel", "ggsignif", "gh", "git2r", "glue", "hms", "htmlTable", "htmltools", "htmlwidgets", "httpuv", "isoband", "jsonlite", "knitr", "labeling", "lifecycle", "magrittr", "MASS", "matrixStats", "memoise", "mime", "openssl", "pillar", "pkgbuild", "pkgload", "processx", "promises", "ps", "R6", "Rcpp", "RcppArmadillo", "readr", "rlang", "rprojroot", "RSQLite", "rstudioapi", "servr", "shiny", "stringi", "survival", "testthat", "tibble", "tidyr", "usethis", "vctrs", "withr", "xfun"))
file.exists("~/.ssh/id_rsa.pub")
install.packages("RcppParallel")
library(RcppParallel)
library(RcppParallel)
library(RcppParallel)
library(RcppParallel)
library(RcppParallel)
library(RcppParallel)
library(RcppParallel)
library(readr)
out_card <- read_delim("Documentos/UOCMaster/test2/out.card.tsv",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
View(out_card)
table(out_card$X2)
table(out_card$X3)
table(out_card$X3, out_card$X2)
table(out_card$X3, out_card$X2, addmargins())
table(out_card$X3, out_card$X2, addmargins=TRUE)
addmargins(table(out_card$X3, out_card$X2))
knitr::opts_chunk$set(echo = TRUE)
help(head)
library(readr)
library(kable)
library(readr)
library(knitr)
out_card <- read_delim("Documentos/UOCMaster/ARIBA/out.card.tsv",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
kable(head(out_card,20)
library(readr)
library(knitr)
out_card <- read_delim("Documentos/UOCMaster/ARIBA/out.card.tsv",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
kable(head(out_card, n=20L)
kable(head(out_card, n=20L))
head(out_card, n=20L)
library(readr)
library(knitr)
out_card <- read_delim("Documentos/UOCMaster/ARIBA/out.card.tsv",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
kable(head(out_card, n=20L))
addmargins(table(out_card$X3, out_card$X2))
library(dplyr)
n_distinct(out_card$X1)
1094-239
install.packages("ggVennDiagram")
install.packages("units")
install.packages("units")
library(devtools)
devtools::install_github("benjjneb/dada2")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "~/Documentos/Repos/UOC-Master/testOutputs")
library(readr)
gene_mapping_data <- read_delim("RGI/RTC_149_RGI_output.gene_mapping_data.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
allele_mapping_data <- read_delim("RGI/RTC_149_RGI_output.allele_mapping_data.txt", "\t", escape_double = FALSE, trim_ws = TRUE)
library(dplyr)
totalMapReads<-19968 ##value obtained from *overall_mapping_stats.txt
totalNumReads<-	17072992
allele_mapping_data<-allele_mapping_data%>%mutate(RPKM=`All Mapped Reads` /(`Reference Length`/1000 * totalNumReads/1000000))
gene_mapping_data<-gene_mapping_data%>%mutate(RPKM=`All Mapped Reads` /(`Reference Length`/1000 * totalNumReads/1000000))
library(ggplot2)
ggplot(allele_mapping_data, aes(`Average MAPQ (Completely Mapped Reads)`)) +
geom_histogram(bins=50, aes(y = stat(density)))+geom_density()+theme_bw()
ggplot(allele_mapping_data, aes(`Average MAPQ (Completely Mapped Reads)`)) +
geom_histogram(bins=50)+theme_bw()
allele_mapping_data<-allele_mapping_data%>%filter(`Average MAPQ (Completely Mapped Reads)`>10)
library(knitr)
n_distinct(allele_mapping_data$`AMR Gene Family`)
AMR_family_RGI<-allele_mapping_data%>%
group_by(`AMR Gene Family`)%>%
summarise('number of AMR genes per family (RGI)'=n(),
sum_RPKM_RGI=sum(RPKM),
avg_MAPQ=mean(`Average MAPQ (Completely Mapped Reads)`),
q1_MAPQ=quantile(`Average MAPQ (Completely Mapped Reads)`, 0.25),
p3_MAPQ=quantile(`Average MAPQ (Completely Mapped Reads)`,0.75),)%>%arrange(desc(sum_RPKM_RGI))
kable(head(AMR_family_RGI))
str(AMR_family_RGI$`sum RPKM (RGI)`)
library(readr)
aro_index <- read_delim("aro_index.tsv",
"\t", escape_double = FALSE, trim_ws = TRUE)
library(stringr)
library(reshape2)
y<-colsplit(report$ref_name, "\\.", c("ARO Term", "ARO Acession","NCBI","init_final","Model Sequence ID","X"))
report <- read_delim("ARIBA/report.tsv",
"\t", escape_double = FALSE, trim_ws = TRUE)
report<-report%>% filter(gene==1)%>%select(c(1:8,31))%>%unique()
AribaMapReds<-5803 ##obtained from minimap.properPairs
totalNumReads<-	17072992
report<-report%>%mutate(RPKM=reads /(ref_len/1000 * totalNumReads/1000000))
library(readr)
aro_index <- read_delim("aro_index.tsv",
"\t", escape_double = FALSE, trim_ws = TRUE)
library(stringr)
library(reshape2)
y<-colsplit(report$ref_name, "\\.", c("ARO Term", "ARO Acession","NCBI","init_final","Model Sequence ID","X"))
y$NCBI<-ifelse(str_detect(y$init_final, "_"),y$NCBI ,paste(y$NCBI,".",y$init_final) )
y$init_final<-ifelse(str_detect(y$init_final, "_"), y$init_final, y$`Model Sequence ID`)
y$`Model Sequence ID`<-ifelse(str_detect(y$`Model Sequence ID`, "_"), y$X, y$`Model Sequence ID`)
y<-select(y, -X)
report<-cbind(report,y)
report<-merge(report, select(aro_index,`Model Sequence ID`, `AMR Gene Family`,`Drug Class`, `Resistance Mechanism` ) , by="Model Sequence ID")
str(report$rp)
View(report)
install.packages('car')
library(car)
install.packages('ggpubr')
library(ggpubr)
install.packages('dplyr')
install.packages('dplyr')
install.packages("rlang")
rlang --version
version(rlang)
packageVersion("rlang")
update.packages("rlang")
packageVersion("rlang")
q()
install.packages("rlang")
remotes::install_github("r-lib/rlang")
install.packages("https://cran.r-project.org/src/contrib/Archive/rlang/rlang_0.4.9.tar.gz", repo=NULL, type="source")
R version
version(R)
version()
q()
install.packages("rlang")
devtools::install_cran("rlang")
install.packages("devtools")
knitr::opts_chunk$set(echo = FALSE)
knit_with_parameters('~/Documentos/Sesion_LefSe.Rmd')
library(devtools)
install.packages("devtools")
install.packages("dplyr")
help(list.files)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "~/Documentos/Repos/UOC-Master/testOutputs")
library(dplyr)
RGIMapReads<-19968 ##value obtained from *overall_mapping_stats.txt
totalNumReads<-	17072992
allele_mapping_data<-allele_mapping_data%>%mutate(RPKM=`All Mapped Reads` /(`Reference Length`/1000 * totalNumReads/1000000))
gene_mapping_data<-gene_mapping_data%>%mutate(RPKM=`All Mapped Reads` /(`Reference Length`/1000 * totalNumReads/1000000))
setwd("~/Documentos/Repos/UOC-Master/PRJNA307231")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "~/Documentos/Repos/UOC-Master/PRJNA307231")
setwd("~/Documentos/Repos/UOC-Master/PRJNA307231")
library(readr)
metadata <- read_delim("samples_metadata.csv",
"\t", escape_double = FALSE, trim_ws = TRUE)
View(metadata)
View(metadata)
setwd("~/Documentos/Repos/UOC-Master/PRJNA307231")
library(readr)
metadata <- read_delim("samples_metadata.csv",
"\t", escape_double = FALSE, trim_ws = TRUE)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = "~/Documentos/Repos/UOC-Master/PRJNA307231")
setwd("~/Documentos/Repos/UOC-Master/PRJNA307231")
library(readr)
metadata <- read_delim("samples_metadata.csv",
"\t", escape_double = FALSE, trim_ws = TRUE)
View(metadata)
library(readr)
totalNumReads <- read_delim("totalNumReads.csv",
"\t", escape_double = FALSE, col_names = FALSE,
trim_ws = TRUE)
names(totalNumReads)
View(metadata)
names(totalNumReads)<-c("Run", "totalNumReads")
View(totalNumReads)
metadata<-merge(metadata, totalNumReads, by="Run")
View(metadata)
help("list.files")
list.files()
list.files("/RGI_analysis")
list.files("~/Documentos/Repos/UOC-Master/PRJNA307231/RGI_analysis")
list.files("~/Documentos/Repos/UOC-Master/PRJNA307231/RGI_analysis", *.data.txt)
list.files("~/Documentos/Repos/UOC-Master/PRJNA307231/RGI_analysis", "*.data.txt")
x<-list.files("~/Documentos/Repos/UOC-Master/PRJNA307231/RGI_analysis", "*.data.txt")
str(x)
x[1]
x<-list.files("/RGI_analysis", "*.data.txt")
x[1]
x<-list.files("~/Documentos/Repos/UOC-Master/PRJNA307231/RGI_analysis", "*.data.txt")
x[1]
x<-list.files("RGI_analysis", "*.data.txt")
x[1]
x<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
x<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
x[1]
help(lapply)
help("read_delim")
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
ldf <- lapply(filenames, read_delim(delim="\t", escape_double = FALSE, trim_ws = TRUE))
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
ldf <- lapply(filenames, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
ldf <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
View(ldf)
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
RGI_data <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
names(RGI_data)
names(RGI_data)[1]
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
RGI_data <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
names(RGI_data)[1]
RGI_data[1]
names(RGI_data)
RGI_files
metadata$Run
RGI_files
metadata$Run
RGI_files
metadata$Run
names_RGI_files<-metadata$Run
RGI_files
metadata$Run
names(RGI_files)<-metadata$Run
names(RGI_files)
RGI_files
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
RGI_data <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
RGI_files
metadata$Run
names(RGI_data)<-metadata$Run
names(RGI_data)
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
RGI_data <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
RGI_files
metadata$Run
names(RGI_data)<-metadata$Run
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
RGI_data <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
RGI_files
metadata$Run
names(RGI_data)<-metadata$Run
RGI_data$SRR6714072
metadata$totalNumReads
metadata$totalNumReads[1]
names(RGI_data)
names(RGI_data)[1]
lapply(RGI_data, function(x) names(x))
lapply(RGI_data, function(x) x)
lapply(RGI_data, function(x) names(x))
RGI_data$SRR6714072
str(RGI_data)
help(mapply)
lapply(RGI_data, function(x) dim(x)[1])
RGI_data[1]
RGI_data[2]
x<-RGI_data[2]
View(x)
dim(RGI_data)
length(RGI_data)
RGI_data2<-RGI_data
View(metadata)
totalNumReads<-35799840
RGI_data2<-RGI_data
RGI_data2[1]<-RGI_data2[1]%>%mutate(RPKM=`All Mapped Reads` /(`Reference Length`/1000 * totalNumReads/1000000))
library(dplyr)
library(dplyr)
totalNumReads<-35799840
RGI_data2<-RGI_data
RGI_data2[1]<-RGI_data2[1]%>%mutate(RPKM=`All Mapped Reads` /(`Reference Length`/1000 * totalNumReads/1000000))
```{r}
help(unlist)
```
```{r}
RGI_data2<-unlist(RGI_data)
```
```{r}
RGI_data2<-unlist(RGI_data)
RGI_data[[1]]
```
RGI_data2[[1]]<-RGI_data2[[1]]%>%mutate(RPKM=`All Mapped Reads` /(`Reference Length`/1000 * totalNumReads/1000000))
```{r}
RGI_data2<-unlist(RGI_data)
str(RGI_data[[1]])
```
```{r}
RGI_data
```
```{r}
RGI_data[1]
```
RGI_data[[1]]
str(RGI_data[[1]])
RGI_data[[1]]$`Reference Sequence`
RGI_data[[1]]$RPKM<-RGI_data[[1]]$`Reference Sequence`+1
RGI_data[[1]]$RPKM<-RGI_data[[1]]$`Completely Mapped Reads`+1
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
RGI_data <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
RGI_files
metadata$Run
names(RGI_data)<-metadata$Run
str(RGI_data[[1]])
RGI_data2<-RGI_data
totalNumReads
RGI_data2<-RGI_data
RGI_data2[[1]]$RPKM<-RGI_data2[[1]]$`All Mapped Reads`/(RGI_data2[[1]]$`Reference Length`/1000 * totalNumReads/1000000)
View(RGI_data2)
for (i in 1:length(RGI_data)){
RGI_data[[i]]$RPKM<-RGI_data[[i]]$`All Mapped Reads`/(RGI_data2[[i]]$`Reference Length`/1000 * totalNumReads/1000000)
}
View(RGI_data)
metadata$totalNumReads
metadata$totalNumReads[1]
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
RGI_data <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
RGI_files
metadata$Run
names(RGI_data)<-metadata$Run
for (i in 1:length(RGI_data)){
RGI_data[[i]]$RPKM<-RGI_data[[i]]$`All Mapped Reads`/(RGI_data2[[i]]$`Reference Length`/1000 * metadata$totalNumReads[i]/1000000)
}
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
RGI_data <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
RGI_data <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
RGI_files<-list.files("RGI_analysis", "*.data.txt", full.names = TRUE)
RGI_data <- lapply(RGI_files, function (x) read_delim(x, delim="\t", escape_double = FALSE, trim_ws = TRUE))
help(lapply)
plots<-function(x){ggplot(x, aes(`Average MAPQ (Completely Mapped Reads)`)) +
geom_histogram(bins=50, aes(y = stat(density)))+geom_density()+theme_bw()}
plots(RGI_data[[1]])
library(ggplot2)
plots(RGI_data[[1]])
library(ggplot2)
ggplot(allele_mapping_data, aes(`Average MAPQ (Completely Mapped Reads)`)) +
geom_histogram(bins=50, aes(y = stat(density)))+geom_density()+theme_bw()
loadfonts(dev="win")
install.packages("extrafont")
extrafont::font_import()
library(ggplot2)
ggplot(allele_mapping_data, aes(`Average MAPQ (Completely Mapped Reads)`)) +
geom_histogram(bins=50, aes(y = stat(density)))+geom_density()+theme_bw()
